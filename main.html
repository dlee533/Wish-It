<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>WishIt Home</title>
  <!-- The core Firebase JS SDK is always required and must be listed first -->

  <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-firestore.js"></script>
  <script src="firebaseConfig.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  <link rel='stylesheet' type='text/css' href="mainCSS.css">
</head>

<body>
  <!-- header -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
      <a class="navbar-brand" href="main.html">WishIt</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
        aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" id="myProfile">My Profile</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" id="myFriends">Friends</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link signOut" href="index.html">Sign out</a>
            <!--change the text when the user signs in -->
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- search bar-->
  <div class='container'></div>
  <div class="form-inline center col-12 col-md-10 col-lg-8">
    <select class="browser-default custom-select col-2 dropdownMenu" id="dropDownSelect">
      <option selected value="users">User</option>
      <option value="items">Item</option>
    </select>
    <input id="queryText" class="form-control col-8 search-bar" type="text" placeholder="Search" aria-label="Search">
    <button id="queryButton" type='submit' onclick="querySearch()" class='btn search-btn col-2'>Search</button>
  </div>
  </div>

  <!--Item display-->
  <div id="display">
    <div class='jumbotron'>
      <h1 class='display-3'>Technology</h1>
      <div class='row'>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
      </div>
    </div>

    <div class='jumbotron'>
      <h1 class='display-3'>Clothing</h1>
      <div class='row'>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
      </div>
    </div>

    <div class='jumbotron'>
      <h1 class='display-3'>Office</h1>
      <div class='row'>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
      </div>
    </div>

    <div class='jumbotron'>
      <h1 class='display-3'>Sports</h1>
      <div class='row'>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
      </div>
    </div>

    <div class='jumbotron'>
      <h1 class='display-3'>House products</h1>
      <div class='row'>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
        <div class='card col-6 col-sm-4 col-md-3 col-lg-2'>
          <div class='card-body'>
            <img class='itemImage' src='bcit_logo.png'>
            <p class='itemNmae'>Name</p>
            <p class='itemPrice'>Price</p>
            <button class="addItem">Add to wishlist</button>
          </div>
        </div>
      </div>
    </div>
  </div>


  <script>
    var db = firebase.firestore();
    console.log("ver 1.2");
    let itemIdNumberMap;    // to be used for onclick events of individual items (write to db for adding into the user's wishlist)
    function readAllItems() {
      let itemNamesList = [];
      let priceList = [];
      let imgSrcList = [];
      let itemIdList = [];
      //db.collection("items").get().then(function(querySnapshot) {
      //    querySnapshot.forEach(function(doc) {
      // doc.data() is never undefined for query doc snapshots
      //console.log(doc.id, " => ", doc.data());
      //store elements with same class name as list
      let itemAddItemClassElemList = document.getElementsByClassName("addItem");
      let itemNameClassElemList = document.getElementsByClassName("itemNmae");
      let itemPriceClassElemList = document.getElementsByClassName("itemPrice");
      let itemImageClassElemList = document.getElementsByClassName("itemImage");
      let uid = localStorage.getItem('userId');
      let userWishListRef = db.collection("users").doc(uid).collection("wishlist");
      let i = 0;
      db.collection("items").where("category", "==", "tech").limit(6).get().then(function (querySnapshot) {
        querySnapshot.forEach(function (doc) {
          // doc.data() is never undefined for query doc snapshots
          //    console.log(doc.id, " => ", doc.data());
          let item_name = String(doc.id);
          itemNameClassElemList[i].innerHTML = doc.id;
          itemPriceClassElemList[i].innerHTML = doc.data().price
          itemImageClassElemList[i].setAttribute("src", doc.data().img_src);
          itemAddItemClassElemList[i].onclick = function () {
            userWishListRef.doc(item_name).set({
              itemRef: db.doc("items/" + item_name)
            });
          }
          i++;
        });
      });
      db.collection("items").where("category", "==", "clothing and shoes").limit(6).get().then(function (querySnapshot) {
        querySnapshot.forEach(function (doc) {
          // doc.data() is never undefined for query doc snapshots
          //    console.log(doc.id, " => ", doc.data());
          let item_name = String(doc.id);
          itemNameClassElemList[i].innerHTML = doc.id;
          itemPriceClassElemList[i].innerHTML = doc.data().price
          itemImageClassElemList[i].setAttribute("src", doc.data().img_src);
          itemAddItemClassElemList[i].onclick = function () {
            userWishListRef.doc(item_name).set({
              itemRef: db.doc("items/" + item_name)
            });
          }
          i++;
        });
      });
      db.collection("items").where("category", "==", "office equipment").limit(6).get().then(function (querySnapshot) {
        querySnapshot.forEach(function (doc) {
          // doc.data() is never undefined for query doc snapshots
          //    console.log(doc.id, " => ", doc.data());
          let item_name = String(doc.id);
          itemNameClassElemList[i].innerHTML = doc.id;
          itemPriceClassElemList[i].innerHTML = doc.data().price
          itemImageClassElemList[i].setAttribute("src", doc.data().img_src);
          itemAddItemClassElemList[i].onclick = function () {
            userWishListRef.doc(item_name).set({
              itemRef: db.doc("items/" + item_name)
            });
          }
          i++;
        });
      });
      db.collection("items").where("category", "==", "sports equipment").limit(6).get().then(function (querySnapshot) {
        querySnapshot.forEach(function (doc) {
          // doc.data() is never undefined for query doc snapshots
          //    console.log(doc.id, " => ", doc.data());
          let item_name = String(doc.id);
          itemNameClassElemList[i].innerHTML = doc.id;
          itemPriceClassElemList[i].innerHTML = doc.data().price
          itemImageClassElemList[i].setAttribute("src", doc.data().img_src);
          itemAddItemClassElemList[i].onclick = function () {
            userWishListRef.doc(item_name).set({
              itemRef: db.doc("items/" + item_name)
            });
          }
          i++;
        });
      });
      db.collection("items").where("category", "==", "house products").limit(6).get().then(function (querySnapshot) {
        querySnapshot.forEach(function (doc) {
          // doc.data() is never undefined for query doc snapshots
          //    console.log(doc.id, " => ", doc.data());
          let item_name = String(doc.id);
          itemNameClassElemList[i].innerHTML = doc.id;
          itemPriceClassElemList[i].innerHTML = doc.data().price
          itemImageClassElemList[i].setAttribute("src", doc.data().img_src);
          itemAddItemClassElemList[i].onclick = function () {
            userWishListRef.doc(item_name).set({
              itemRef: db.doc("items/" + item_name)
            });
          }
          i++;
        });
      });
    }
    readAllItems();
    function myProfileDirect() {
      let my_profile = document.getElementById("myProfile");
      my_profile.onclick = function () {
        window.location.href = "profile.html?" + localStorage.getItem('userId');
      };
    }
    myProfileDirect();
    function myFriendsDirect() {
      let my_friends = document.getElementById("myFriends");
      my_friends.onclick = function () {
        window.location.href = "friendsList.html?" + localStorage.getItem('userId');
      };
    }
    myFriendsDirect();
    function querySearch() {
      let selection = document.getElementById("dropDownSelect").value;
      //let btn = document.getElementById("queryButton");
      let query = document.getElementById("queryText").value;
      //btn.onclick = function() {
      window.location.href = "searchResult.html?" + selection + '=' + query;
      //}
    }
  </script>
  <script src="signout.js"></script>
</body>

</html>